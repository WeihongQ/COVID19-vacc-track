### Erqian Xu, Yongyi Zang, Weihong Qi

This is the readme file for data processing and tests. To test the function of our database, five  “.csv” files are generated by the data simulation process in R. The five files are the tables in the database, including “student”, “teacher”, “health_worker”, “grades” and “vaccination_records”. This file describes the simulation process of each variable in all the tables, including the distribution, sample size and the logic to reflect the practices of the database.

## Realname, ID, Username, and Password
For each type of users, the realname, ID, username and password are randomly generated by the `sample` function in R. There are three steps to generate each ID, username or password:

1. Generate random letters and numbers and store them as new temporary columns in existing data frame
2. Combine all the new columns into one new column
3. Remove all the temporary columns and rename the new column as "username", "ID" or "password"

Three random letters and three random numbers are simulated by the `sample` function and different seeds respectively.

```
set.seed(1)
  teacher$u1 <- sample(letters, size = 10, replace = T)
set.seed(2)
  teacher$u2 <- sample(letters, size = 10, replace = T)
set.seed(3)
  teacher$u3 <- sample(letters, size = 10, replace = T)
  teacher$u4 <- sample(100:999, size = 10, replace = F)
```
`unite` and `cbind` functions are used for generating the final simulated variable.

```
username <- unite(teacher, 'username', u1, u2, u3, u4, sep='')

teacher <- cbind(teacher, username[,2])
```

Note that to follow the best practices in database security when dealing with login information, we salted and hashed the password in order to protect ourselves against rainbow table attacks. The password stored in our database is calculated using md5(password_pre + ‘csc261’). The vaccination records are set to be with 0.8 probability to be vaccinated for each shot. `sapply` and `digest` function are used to gernate the md5 password.

```
teacher$password <- sapply(teacher$password_pre, digest, algo='md5')
```

The random real names are generated by an online random name gernator.

## Grades
Grades for each student in each of the three exams are randomized on a normal distribution with mean as 70 and standard error as 10.

```
set.seed(99)
grades$first_grade <- rnorm(200, mean = 70, sd=10)
grades$first_grade <- round(grades$first_grade)
```


## Vaccination Records
Vaccination records take a binary value of "yes" or "no" for each shot. The probability for each student to take each shot is 80%.

```
vaccination_records$first_vaccine <- sample(vacc, 200, replace = T, prob=c(0.8,0.2))
```

If the student has not been vaccinated for the first shot, then she will not have the second and the third shot. The vaccination date is at the same time generated with the vaccination status. A loop is used to fit the logic of vaccination:

```
for(i in 1:200){
    if(vaccination_records$first_vaccine[i] == 'yes'){
        vaccination_records$second_vaccine[i] <- sample(vacc,1, replace = T, prob=c(0.8,0.2))
        vaccination_records$vd[i] <- sample(day,1)
        vaccination_records$vm[i] <- sample(month,1)
        vaccination_records$vy[i] <- 2020
    }
    else{
        vaccination_records$second_vaccine[i] <- 'no'
    }
}

first_vaccine_date<- unite(vaccination_records,"first_vaccine_date",vy,vm,vd, sep="-")
first_vaccine_date[,6] <- as.Date(first_vaccine_date[,6])
```
## Sex and Age
Sex of each student is a binary of "F" or "M". Each student is randomly assigned either sex with equal probability.
```
sex <- c('F','M')
student$sex <- sample(sex, 200, replace = T)
```

Age is randomly assigned to each student ranging from 18 to 25 with equal probability.
```
age <- c(18:25)
student$age <- sample(age,200, replace = T)
```
